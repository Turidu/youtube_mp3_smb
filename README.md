# YouTube MP3 Синхронизатор

Приложение для автоматической загрузки MP3 файлов из YouTube плейлиста и размещения их на SMB сетевом диске.

## Особенности

- ✅ Загрузка MP3 из YouTube плейлиста
- ✅ Отслеживание уже загруженных файлов (избегает повторных загрузок)
- ✅ Автоматическая загрузка на SMB сетевой диск
- ✅ Автоматическое создание M3U плейлистов на SMB сервере
- ✅ Поддержка множественных плейлистов с индивидуальными настройками SMB
- ✅ Проверка целостности файлов через MD5 хеши
- ✅ Чанковая загрузка больших файлов
- ✅ Автоматическое удаление временных файлов
- ✅ Чистая архитектура с соблюдением принципов ООП, SOLID и DRY
- ✅ Подробное логирование процесса
- ✅ Обработка ошибок и восстановление

## Требования

- Python 3.11+
- FFmpeg (для конвертации аудио)
- Доступ к SMB серверу

## Установка

1. **Клонируйте или скачайте проект**

2. **Создайте виртуальное окружение:**
   ```bash
   python -m venv venv
   ```

3. **Активируйте виртуальное окружение:**
   
   Windows:
   ```bash
   venv\Scripts\activate
   ```
   
   Linux/Mac:
   ```bash
   source venv/bin/activate
   ```

4. **Установите зависимости:**
   ```bash
   pip install -r requirements.txt
   ```

5. **Установите FFmpeg:**
   - Windows: Скачайте с https://ffmpeg.org/download.html и добавьте в PATH
   - Linux: `sudo apt install ffmpeg`
   - Mac: `brew install ffmpeg`

## Настройка

Откройте файл `config.py` и заполните параметры SMB подключения:

```python
# Настройки SMB (обязательно заполнить!)
SMB_SERVER = "192.168.1.100"  # IP адрес вашего SMB сервера
SMB_SHARE = "music"           # Имя SMB шары
SMB_USERNAME = "your_username"
SMB_PASSWORD = "your_password"
SMB_DOMAIN = ""               # Домен (если требуется)
```

## Использование

Запустите приложение:

```bash
python main.py
```

Приложение автоматически:
1. Получит список видео из плейлиста
2. Проверит, какие файлы уже загружены
3. Загрузит новые MP3 файлы
4. Загрузит их на SMB сервер
5. Обновит список загруженных файлов

## Структура проекта

```
├── main.py                 # Главный файл приложения
├── config.py              # Конфигурация
├── interfaces.py          # Абстрактные интерфейсы
├── youtube_mp3_sync.py    # Основной класс синхронизатора
├── logger.py              # Система логирования
├── download_tracker.py    # Отслеживание загруженных файлов
├── playlist_extractor.py  # Извлечение плейлиста YouTube
├── audio_downloader.py    # Загрузка аудио
├── smb_uploader.py        # Загрузка на SMB сервер
├── requirements.txt       # Зависимости Python
├── downloaded.json        # База загруженных файлов (создается автоматически)
└── temp_downloads/        # Временная папка (создается автоматически)
```

## Архитектура

Проект построен с соблюдением принципов SOLID:

- **Single Responsibility**: Каждый класс отвечает за одну задачу
- **Open/Closed**: Легко расширяется новыми реализациями интерфейсов
- **Liskov Substitution**: Все реализации взаимозаменяемы
- **Interface Segregation**: Интерфейсы разделены по функциональности
- **Dependency Inversion**: Зависимости внедряются через конструкторы

## Логирование

Все операции логируются в консоль с указанием времени и уровня сообщения:
- `INFO`: Обычные операции
- `WARNING`: Предупреждения
- `ERROR`: Ошибки

## Обработка ошибок

- Автоматическое восстановление после сетевых ошибок
- Пропуск поврежденных видео
- Очистка временных файлов
- Безопасное отключение от SMB сервера

## Файлы

- `downloaded.json`: Содержит список уже загруженных видео с метаданными
- `temp_downloads/`: Временная папка для загрузки MP3 (автоматически очищается)

## Устранение неполадок

### Ошибка "FFmpeg not found"
Установите FFmpeg и убедитесь, что он доступен в PATH.

### Ошибка подключения к SMB
Проверьте:
- Правильность IP адреса сервера
- Доступность SMB сервера в сети
- Корректность имени пользователя и пароля
- Права доступа к указанной шаре

### Ошибка загрузки YouTube
- Проверьте интернет-соединение
- Убедитесь, что плейлист публичный
- Попробуйте обновить yt-dlp: `pip install --upgrade yt-dlp`

## Лицензия

Этот проект предназначен для личного использования. Убедитесь, что соблюдаете авторские права при загрузке контента.
